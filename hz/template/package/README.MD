## 自定义一个 package 模板

> 与 layout 模板一样，用户同样可以自定义 package 模板。
>
> 就 package 提供的模板来说，一般用户可能只有自定义 handler.go 的模板的需求，因为router.go/middleware.go/register.go 一般与 idl 定义相关而用户无需关心，因此 hz 目前也将这些模板生成的位置固定了，一般也无需修改。
>
> 因此，用户可根据自身的需求来自定义生成的 handler 模板，加速开发速度；但是由于默认的 handler 模板集成了一些 model 的信息以及 package 信息，所以需要 hz 工具来提供渲染数据。这部分用户可根据自身情况酌情来修改，一般建议留下 model 信息。

下面给出一个简单的自定义 handler 模板的示例，在 handler 里加入一些注释：

### template:

```
 # 以下数据都是yaml marshal得到的，所以可能看起来比较乱
layouts:
  # path只表示handler.go的模板，具体的handler路径由默认路径和handler_dir决定
- path: handler.go
    delims:
      - '{{'
      - '}}'
    body: "// this is my custom handler.\n\npackage {{.PackageName}}\n\nimport (\n\t"context"\n\n\t"github.com/cloudwego/hertz/pkg/app"\n\n
    {{- range $k, $v := .Imports}}\n\t{{$k}} "{{$v.Package}}"\n{{- end}}\n)\n\n{{range $_, $MethodInfo := .Methods}}\n{{$MethodInfo.Comment}}\n
    func {{$MethodInfo.Name}}(ctx context.Context, c *app.RequestContext) { \n
    \t//  you can code something \n\tvar err error\n\t{{if ne $MethodInfo.RequestTypeName "" -}}\n\t
    var req {{$MethodInfo.RequestTypeName}}\n\terr = c.BindAndValidate(&req)\n\tif err != nil {\n\t\tc.String(400, err.Error())\n\t\treturn\n\t}\n\t{{end}}\n
    \tresp := new({{$MethodInfo.ReturnTypeName}})\n\n\tc.{{.Serializer}}(200, resp)\n}\n{{end}}\n\t\t\t"
  # path只表示router.go的模板，其路径固定在：biz/router/namespace/
- path: router.go
    delims:
      - '{{'
      - '}}'
    body: "// Code generated by hertz generator. DO NOT EDIT.\n\npackage {{$.PackageName}}\n\nimport
  (\n\t"github.com/cloudwego/hertz/pkg/app/server"\n\n\t{{range $k, $v := .HandlerPackages}}{{$k}}
  "{{$v}}"{{end}}\n)\n\n/*\n This file will register all the routes of the services
  in the master idl.\n And it will update automatically when you use the "update"
  command for the idl.\n So don't modify the contents of the file, or your code will
  be deleted when it is updated.\n */\n\n{{define "g"}}\n{{- if eq .Path "/"}}r\n{{-
  else}}{{.GroupName}}{{end}}\n{{- end}}\n\n{{define "G"}}\n{{- if ne .Handler ""}}\n\t{{-
  .GroupName}}.{{.HttpMethod}}("{{.Path}}", append({{.MiddleWare}}Mw(), {{.Handler}})...)\n{{-
  end}}\n{{- if ne (len .Children) 0}}\n{{.MiddleWare}} := {{template "g" .}}.Group("{{.Path}}",
  {{.MiddleWare}}Mw()...)\n{{- end}}\n{{- range $_, $router := .Children}}\n{{- if
  ne .Handler ""}}\n\t{{template "G" $router}}\n{{- else}}\n\t{\t{{template "G"
  $router}}\n\t}\n{{- end}}\n{{- end}}\n{{- end}}\n\n// Register register routes based
  on the IDL 'api.${HTTP Method}' annotation.\nfunc Register(r *server.Hertz) {\n{{template
  "G" .Router}}\n}"
  # path只表示register.go的模板，register的路径固定为biz/router/register.go
- path: register.go
    delims:
      - ""
      - ""
    body: "// Code generated by hertz generator. DO NOT EDIT.\n\npackage router\n\nimport (\n\t"github.com/cloudwego/hertz/pkg/app/server"\n\t{{$.PkgAlias}}
  "{{$.Pkg}}"\n)\n\n// GeneratedRegister registers routers generated by IDL.\nfunc
  GeneratedRegister(r *server.Hertz){\n\t//INSERT_POINT: DO NOT DELETE THIS LINE!\n\t{{$.PkgAlias}}.Register(r)\n}\n"
  - path: model.go
    delims:
      - ""
      - ""
    body: ""
  # path只表示middleware.go的模板，middleware的路径和router.go一样为：biz/router/namespace/
- path: middleware.go
    delims:
      - '{{'
      - '}}'
    body: "// Code generated by hertz generator.\n\npackage {{$.PackageName}}\n\nimport (\n\t"github.com/cloudwego/hertz/pkg/app"\n)\n\n{{define
  "M"}}\nfunc {{.MiddleWare}}Mw() []app.HandlerFunc {\n\t// your code...\n\treturn
  nil\n}\n{{range $_, $router := $.Children}}{{template "M" $router}}{{end}}\n{{-
  end}}\n\n{{template "M" .Router}}\n\t\t"
  # path只表示client.go的模板，client代码的生成路径由用户指定"${client_dir}"
- path: client.go
  delims:
    - '{{'
    - '}}'
  body: "// Code generated by hertasdasdsadaz generator.\n\npackage {{$.PackageName}}\n\nimport (\n
\   "github.com/cloudwego/hertz/pkg/app/client"\n\t"github.com/cloudwego/hertz/pkg/common/config"\n)\n\ntype
{{.ServiceName}}Client struct {\n\tclient * client.Client\n}\n\nfunc New{{.ServiceName}}Client(opt
...config.ClientOption) (*{{.ServiceName}}Client, error) {\n\tc, err := client.NewClient(opt...)\n\tif
err != nil {\n\t\treturn nil, err\n\t}\n\n\treturn &{{.ServiceName}}Client{\n\t\tclient:
c,\n\t}, nil\n}\n\t\t"
```

### 命令:
```
hz new --mod=github.com/hertz/hello --handler_dir=handler_test --idl=idl/hello.thrift --customize_package=template/package.yaml:
```